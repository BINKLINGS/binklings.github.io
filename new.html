 <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>welcome to BINKLINGS</title>
    <meta name="description" content="BINKLINGS official website">
    <style>
    .search{
     backdrop-filter: blur(5px);
     border-radius: 25px;
     text-align: center;
     width: 30%;
     color: white;
     margin: 80px;
     height: 40px;
     background-color: transparent;
     z-index: 9999;
     transition: all 0.25s ease-in-out;
     border: 2px solid white;
     outline: none
    }
    .search:focus{
     background-color: #212529;
     border-radius: 15px;
     color: white;
     width: 50%;
     transition: all 0.2s ease-in-out;
     border: 3px solid white;
    }
    .search2{
     backdrop-filter: blur(5px);
     border-radius: 15px;
     text-align: center;
     width: 96%;
     color: white;
     margin: 2%;
     height: 40px;
     background-color: black;
     z-index: 9999;
     transition: all 0.25s ease-in-out;
     border: 2px solid white;
     outline: none
    }
    .search2:focus{
     background-color: black;
     color: lightblue;
     transition: all 0.2s ease-in-out;
     border: 2px solid lightskyblue
    }
    .info-div{
     width: 90%;
     padding: 15px;
     font-size: 20%;
     border: 2px solid white;
     border-radius: 10px;
     background-color: rgba(255, 255, 255, 0.3);
     backdrop-filter: blur(5px);
    }
    </style>
</head>

<body>
    <nav style="background-color: #212529;padding-top: 2%;padding-bottom: 2%;padding-left: 5%;padding-right: 5%;display: inline-flex;width: 90%;top: 0px;left: 0px;position: absolute" id="main_nav" onclick="playImage()">
        <span style="color: rgb(255, 241, 165);font-size: 22px;">BINKLINGS</span>
    </nav>
    <div align="center" style="height: 100%;" id="main">
     <div align="center" style="height: 100%;padding-top: 20%;z-index: 9999;">
      <h2 id="now" align="center" style="color: white;text-shadow: -0.5px 0.5px 0.5px #000, 0.5px 0.5px 0.5px #000;"></h2>
      <form id="sform">
			    <input id="find" type="text" name="q" class="search" placeholder="Search"/>
      </form>
     </div>
    <script>
        var establishDate = new Date("2022/10/08");
        var today = new Date();
        var diffTime = Math.abs(today - establishDate);
        var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        var p2 = document.getElementById('now')
        
        updateTime()
        function updateTime(){
            p2.innerText = new Date().getHours() + ':' +  new Date().getMinutes() + ':' + new Date().getSeconds()
            setTimeout('updateTime()',1000)
        }
    </script>
    
    <div align="center" style="height: 100%;padding-top: 70%" id="itemsdiv">
    <h2 style="color: white" align="center">Discover something new</h2>
    <br>
    <div align="center">
     <div class="info-div">
      <h2 style="color: white;font-size: 20px" align="center">Weather Now</h2>
     </br>
     <script>
       (function(d, s, id) {
           if (d.getElementById(id)) {
               if (window.__TOMORROW__) {
                   window.__TOMORROW__.renderWidget();
               }
               return;
           }
           const fjs = d.getElementsByTagName(s)[0];
           const js = d.createElement(s);
           js.id = id;
           js.src = "https://www.tomorrow.io/v1/widget/sdk/sdk.bundle.min.js";
           fjs.parentNode.insertBefore(js, fjs);
       })(document, 'script', 'tomorrow-sdk');
       </script>
       <div class="tomorrow" data-location-id="019332" data-language="EN" data-unit-system="METRIC" data-skin="light" data-widget-type="aqiPollen" style="padding-bottom:22px;position:relative;">
           <a href="https://www.tomorrow.io/weather-api/" rel="nofollow noopener noreferrer" target="_blank" style="position: absolute; bottom: 0; transform: translateX(-50%); left: 50%;">
           </a>
       </div>
     </div>
     <br>
     <div class="info-div">
      <h2 style="color: white;font-size: 20px" align="center">Stock</h2>
        <iframe id="customerList" style="border:0px;" src="https://stockstracker.app/userstocks.html?ticks=AAPL,TSLA,BABA,SPY" 
    width=320 height=200>
      </iframe>
     </div>
     <br>
     <div class="info-div" style="height: 600px">
      <h2 style="color: white;font-size: 20px" align="center">NotePad</h2>
      <iframe src="./tools.html" frameborder="0" style="width: 100%;height: 100%"></iframe>
     </div>
     <br>
     <div class="info-div" style="height: 100px;">
      <h2 style="color: white;font-size: 20px" align="center">BINKLINGS Start coming soon</h2>
     </div>
    </div>
    </div>
    </div>
</body>
</html>


<style>
#overlay_searching {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: -1;
  backdrop-filter: blur(5px)
}
#overlay_sleep {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: -1;
}
#overlay_bg {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: -1;
  background-color: black
}
.input-1 {
  border: 2px solid #fff;
  background-color: #000;
  color: #fff;
  border-radius: 5px;
  padding: 5px;
  transition: all 0.25s ease-in-out;
}
.input-1:focus {
  border: 2px solid #000;
  background-color: #fff;
  color: #000;
  border-radius: 5px;
  padding: 5px;
  transition: all 0.25s ease-in-out; */
}
.btn-1 {
  display: inline-block;
  padding: 10px 20px;
  font-size: 16px;
  color: #fff;
  background-color: #000;
  border: none;
  border-radius: 5px;
  box-shadow: 0 0 0 2px #fff;
  transition: all 0.25s ease-in-out;
}
.btn-1:focus {
  background: #fff;
  color: #000;
  transition: all 0.25s ease-in-out;
}
</style>
<script>
document.getElementById("sform").addEventListener("submit", function(event) {
  event.preventDefault(); // 阻止默认的提交事件

  var input = document.getElementById("find");
  var inputValue = input.value;
  processInput(inputValue);
});

function processInput(inputValue) {
  if(inputValue!==''){
   submit(inputValue)
   var i = 0
   var sndiv = document.createElement('div')
   sndiv.style.height = '100%'
   sndiv.style.width = '100%'
   sndiv.style.left = 0
   sndiv.style.top = 0
   sndiv.style.backgroundColor = 'rgb(20,20,20)'
   sndiv.style.position = 'absolute'
   sndiv.style.zIndex = '9999'
   sndiv.innerHTML = `<form id="snform"><input id="input2" class='search2' value='`+inputValue+`' type="text"></input></snform><div id="results"></div>`
   document.body.appendChild(sndiv)
   document.getElementById("snform").addEventListener("submit", function(event) {
    event.preventDefault(); // 阻止默认的提交事件
    document.getElementById('input2').style.color = 'orange'
    document.getElementById('input2').style.border = '2px solid gray'
    submit(document.getElementById('input2').value)
   });
   var si = setInterval(()=>{
    sndiv.style.opacity = i
    if(i>=1){
     document.getElementById('itemsdiv').innerHTML = ''
     var sndiv2 = document.createElement('div')
     sndiv2.style.height = '100%'
     sndiv2.style.width = '100%'
     sndiv2.style.left = 0
     sndiv2.style.top = 0
     sndiv2.style.backgroundColor = 'rgb(20,20,20)'
     sndiv2.style.position = 'fixed'
     sndiv2.style.zIndex = '999'
     document.body.appendChild(sndiv2)
     clearInterval(si)
    }
    i+=0.04
   },1)
  }
}

document.getElementById('find').autocomplete = "off"

light_mode = true
document.body.addEventListener('contextmenu', function(e) {
 e.preventDefault();
 if(light_mode==true){
 overlay_sleep = document.createElement('div')
 overlay_sleep.id = 'overlay_sleep'
 document.body.appendChild(overlay_sleep)
 opacity_sl = 0;
 var intervalId = setInterval(function() {
  opacity_sl += 0.01;
  overlay_sleep.style.backgroundColor = `rgba(0, 0, 0, ${opacity_sl})`;
  main_nav.style.top = opacity_sl*-30+'%'
  if (opacity_sl >= 1) {
    opacity_sl = 1
    clearInterval(intervalId);
  }
 }, 2);
 light_mode = false
}else{
 overlay_sleep = document.getElementById('overlay_sleep')
 opacity_sl = 1;
 var intervalId = setInterval(function() {
  opacity_sl -= 0.01;
  overlay_sleep.style.backgroundColor = `rgba(0, 0, 0, ${opacity_sl})`;
  main_nav.style.top = opacity_sl*-30+'%'
  if (opacity_sl <= 0) {
    opacity_sl = 0
    document.body.removeChild(overlay_sleep)
    clearInterval(intervalId);
  }
 }, 2);
 light_mode = true
}
});

image_mode = false
function playImage() {
 if(image_mode==false){
  image_mode = true
  document.getElementById('main').style.opacity = '1'
  opacity_i = 1;
  var intervalId = setInterval(function() {
  opacity_i -= 0.01;
  document.getElementById('main').style.opacity = opacity_i
  if (opacity_i <= 0) {
    opacity_i = 0
    document.getElementById('main').style.top = '-999999px'
    document.getElementById('main').style.position = 'fixed'
    clearInterval(intervalId);
  }
 }, 2);
 }else{
  image_mode = false
  document.getElementById('main').style.opacity = '0'
  opacity_i = 0;
  document.getElementById('main').style.position = 'static'
  var intervalId = setInterval(function() {
  opacity_i += 0.01;
  document.getElementById('main').style.opacity = opacity_i
  if (opacity_i >= 1) {
    opacity_i = 1
    clearInterval(intervalId);
  }
 }, 2);
 }
};


opacity_s = 0
main_nav = document.getElementById('main_nav')
document.getElementById('find').onfocus = function(){
 overlay_searching = document.createElement('div')
 overlay_searching.id = 'overlay_searching'
 document.body.appendChild(overlay_searching)
 opacity = 0;
 var intervalId = setInterval(function() {
  opacity_s += 0.01;
  overlay_searching.style.backgroundColor = `rgba(0, 0, 0, ${opacity_s})`;
  main_nav.style.top = opacity_s*-30+'%'
  if (opacity_s >= 0.5) {
    opacity_s = 0.5
    clearInterval(intervalId);
  }
}, 2);
}
document.getElementById('find').onblur = function() {
 opacity_s = 0.5;
 var intervalId = setInterval(function() {
  opacity_s -= 0.01;
  overlay_searching.style.backgroundColor = `rgba(0, 0, 0, ${opacity_s})`;
  main_nav.style.top = opacity_s*-30+'%'
  if (opacity_s <= 0) {
   opacity_s = 0
   document.body.removeChild(overlay_searching)
   clearInterval(intervalId);
  }
 }, 2);
}


const img = new Image();
img.src = 'http://42.193.15.31:3000/img/s';
overlay_bg = document.createElement('div');
overlay_bg.id = 'overlay_bg'
overlay_bg.setAttribute('backdrop-filter','blur(5px)')
document.body.appendChild(overlay_bg)
img.onload = function() {
  document.body.style.backgroundImage = `url(${img.src})`;
  opacity_bg = 1;
  var intervalId = setInterval(function() {
    opacity_bg -= 0.02;
    overlay_bg.style.opacity = opacity_bg;
    if (opacity_bg <= 0) {
      clearInterval(intervalId);
      document.body.removeChild(overlay_bg);
    }
  }, 1);
};
document.body.setAttribute('style','background: #000 no-repeat center center;background-size: cover;background-attachment: fixed;')
</script>

<script> 
     if(String(location).includes("https://")){ 
         console.warn("兼容性问题,我们已将连接降级为http而不是https") 
         window.location.href = "http://www.binklings.com/products/test/s"
     } 
     function submit(q){  
          var q = q
          var xhr = new XMLHttpRequest();  
          xhr.addEventListener('load', event => {  
              c = event.target.responseText;  
              console.log(c);  
              if(c=='[]'){  
                  document.getElementById('input2').value = '无结果'
              }else{  
                  show(JSON.parse(c),q)
              }  
          })  
          xhr.open("GET", 'http://42.193.15.31:3000/search/v1?'+q);  
          xhr.send();  
      } 
  
  
function show(dataArray, q) {
    var resultsContainer = document.getElementById("results");
    resultsContainer.innerHTML = '';

    // 计算每个结果与搜索问题的相似程度
    var similarityArray = [];
    for (var i = 0; i < dataArray.length; i++) {
        var similarity = calculateSimilarity(dataArray[i].title, q);
        similarityArray.push({ index: i, similarity: similarity });
    }

    // 根据相似程度降序排序
    similarityArray.sort(function(a, b) {
        return b.similarity - a.similarity;
    });

    // 根据排序结果渲染结果容器
    for (var j = 0; j < similarityArray.length; j++) {
        var resultIndex = similarityArray[j].index;
        var div = document.createElement("div");
        div.className = "result";
        if(dataArray[resultIndex].introduction==null){
         div.innerHTML = "<h3>" + highlightText(dataArray[resultIndex].title, q) + "</h3><a style='color: blue'>"+dataArray[resultIndex].url+"</a>";
        }else{
         div.innerHTML = "<h3>" + highlightText(dataArray[resultIndex].title, q) + "</h3><a style='color: blue'>"+dataArray[resultIndex].url+"</a><p>" + dataArray[resultIndex].introduction + "</p>";
        }
        div.setAttribute("id", "result_" + resultIndex);
        div.addEventListener("click", function() {
            var index = this.getAttribute("id").split("_")[1];
            window.open(dataArray[index].url);
            this.style.color = 'purple'
        });
        resultsContainer.appendChild(div);
        document.getElementById('input2').style.color = 'skyblue'
        document.getElementById('input2').style.border = '2px solid white'
    }
}

// 计算字符串相似程度的函数示例（编辑距离算法）
function calculateSimilarity(str1, str2) {
    var m = str1.length;
    var n = str2.length;
    var dp = [];

    // 初始化二维数组
    for (var i = 0; i <= m; i++) {
        dp[i] = [];
        dp[i][0] = i;
    }
    for (var j = 0; j <= n; j++) {
        dp[0][j] = j;
    }

    // 动态规划计算编辑距离
    for (var i = 1; i <= m; i++) {
        for (var j = 1; j <= n; j++) {
            if (str1.charAt(i - 1) === str2.charAt(j - 1)) {
                dp[i][j] = dp[i - 1][j - 1];
            } else {
                dp[i][j] = Math.min(dp[i - 1][j], dp[i][j - 1], dp[i - 1][j - 1]) + 1;
            }
        }
    }

    // 返回字符串相似程度（这里使用的是归一化的编辑距离）
    return 1 - dp[m][n] / Math.max(m, n);
}

// 高亮显示搜索关键词的函数示例
function highlightText(text, keyword) {
    var regex = new RegExp('[' + keyword + ']', 'gi');
    return text.replace(regex, '<span style="color: lightblue;text-shadow: 0 0 10px #fff, 0 0 10px #fff, 0 0 10px #fff, 0 0 10px black">$&</span>');
}
</script>
<style> 
    .result { 
     background-color: black;
     color: white;
     padding: 2%;
     margin-bottom: 10px;
     cursor: pointer;
     border: 2px solid darkgray;
     border-radius: 15px;
     animation: slide-in 0.3s ease-in-out;
    }
    @keyframes slide-in {
     0% {
      opacity: 0;  /* 初始时设置为全透明 */
      transform: translateY(100px);  /* 初始位置在下方 */
     }
     100% {
      opacity: 1;  /* 不透明 */
      transform: translateY(0);  /* 还原到原位 */
     }
    }
</style>
